<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Calendar</title>
    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@3.10.2/main.min.css" rel="stylesheet">
    <!-- FullCalendar JS -->
    <script src="https://cdn.jsdelivr.net/npm/@fullcalendar/core@3.10.2/main.min.js"></script>
</head>
<body>
    <h1 id="clientHeader">Loading...</h1>
    <!-- Calendar container -->
    <div id="calendar"></div>

    <script>
        // Get the client from the URL parameter
        const params = new URLSearchParams(window.location.search);
        const client = params.get("client"); // Extract client name from the query string
        const display = document.getElementById("clientHeader");

        // Set the page title dynamically
        display.innerText = `Events for ${client.toUpperCase()}`;

        // Fetch the events for the client
        fetch(`data/${client}.json`)
            .then(res => res.json())  // Parse the JSON data
            .then(data => {
                // If there are no events, display a message
                if (data.length === 0) {
                    document.getElementById("calendar").innerHTML = "<p>No events found for this client.</p>";
                    return;
                }

                // Map the events into the format FullCalendar expects
                const events = data.map(event => ({
                    title: event.Event,
                    start: event["Start Date"],  // Start date of the event
                    end: event["End Date"],      // End date of the event
                    location: event.Location     // Event location
                }));

                // Initialize FullCalendar
                const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
                    plugins: ['dayGrid'],  // Use the dayGrid plugin for the calendar view
                    initialView: 'dayGridMonth',  // Default view is the month view
                    events: events,  // Provide the events to the calendar
                    eventClick: function(info) {
                        // Show an alert with the event details when clicked
                        alert(`Event: ${info.event.title}\nLocation: ${info.event.extendedProps.location}`);
                    }
                });

                // Render the calendar
                calendar.render();
            })
            .catch(error => {
                // Handle any errors (e.g., network issues)
                console.error("Error loading events:", error);
                document.getElementById("calendar").innerHTML = "<p>Could not load events for this client.</p>";
            });
    </script>
</body>
</html>


